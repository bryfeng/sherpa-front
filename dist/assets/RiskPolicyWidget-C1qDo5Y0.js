import{dM as C,dU as m,el as P,dO as e,em as N,en as q,eo as E,ep as L,eq as D,dR as w,er as j,es as F}from"./index-DkD0KfRO.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=C("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=C("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=C("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function f({title:o,children:t,defaultOpen:r=!0}){const[l,x]=m.useState(r);return e.jsxs("div",{className:"border rounded-xl",style:{borderColor:"var(--line)"},children:[e.jsxs("button",{type:"button",onClick:()=>x(!l),className:"flex w-full items-center justify-between px-4 py-3 text-left",children:[e.jsx("span",{className:"text-sm font-medium",style:{color:"var(--text)"},children:o}),l?e.jsx(q,{className:"h-4 w-4",style:{color:"var(--text-muted)"}}):e.jsx(E,{className:"h-4 w-4",style:{color:"var(--text-muted)"}})]}),l&&e.jsx("div",{className:"border-t px-4 pb-4 pt-3 space-y-4",style:{borderColor:"var(--line)"},children:t})]})}function b({label:o,value:t,min:r,max:l,step:x=1,unit:u="",hint:s,onChange:i}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:o}),e.jsxs("span",{className:"text-sm font-medium",style:{color:"var(--text)"},children:[t,u]})]}),e.jsx("input",{type:"range",min:r,max:l,step:x,value:t,onChange:p=>i(parseFloat(p.target.value)),className:"w-full h-2 rounded-full appearance-none cursor-pointer",style:{background:`linear-gradient(to right, var(--accent) 0%, var(--accent) ${(t-r)/(l-r)*100}%, var(--surface-3) ${(t-r)/(l-r)*100}%, var(--surface-3) 100%)`}}),s&&e.jsx("p",{className:"text-[11px]",style:{color:"var(--text-muted)"},children:s})]})}function h({label:o,value:t,hint:r,onChange:l}){const[x,u]=m.useState(t.toString());m.useEffect(()=>{u(t.toString())},[t]);const s=()=>{const i=parseFloat(x.replace(/[^0-9.]/g,""));!isNaN(i)&&i>=0?l(i):u(t.toString())};return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:o}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm",style:{color:"var(--text-muted)"},children:"$"}),e.jsx("input",{type:"text",value:x,onChange:i=>u(i.target.value),onBlur:s,className:"w-full rounded-lg border py-2 pl-7 pr-3 text-sm",style:{borderColor:"var(--line)",background:"var(--surface-2)",color:"var(--text)"}})]}),r&&e.jsx("p",{className:"text-[11px]",style:{color:"var(--text-muted)"},children:r})]})}function $({config:o,hasPolicy:t,isSaving:r=!1,onSave:l,onReset:x,onApplyPreset:u}){const[s,i]=m.useState(o),[p,y]=m.useState(null),[n,c]=m.useState(null);m.useEffect(()=>{i(o)},[o]),m.useEffect(()=>{for(const[a,v]of Object.entries(P))if(Object.entries(v.config).every(([M,A])=>s[M]===A)){y(a);return}y(null)},[s]);const d=m.useCallback((a,v)=>{i(S=>({...S,[a]:v})),c(null)},[]),U=async()=>{if(s.warnSlippagePercent>=s.maxSlippagePercent){c("Warn slippage must be less than max slippage");return}if(s.warnGasPercent>=s.maxGasPercent){c("Warn gas must be less than max gas");return}if(s.requireApprovalAboveUsd>s.maxSingleTxUsd){c("Approval threshold cannot exceed max transaction limit");return}try{await l(s)}catch(a){c(a instanceof Error?a.message:"Failed to save")}},R=async a=>{try{await u(a)}catch(v){c(v instanceof Error?v.message:"Failed to apply preset")}},k=JSON.stringify(s)!==JSON.stringify(o);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl",style:{background:"var(--surface-2)"},children:e.jsx(N,{className:"h-5 w-5",style:{color:"var(--accent)"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold",style:{color:"var(--text)"},children:"Trading Risk Preferences"}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Configure limits to protect your portfolio"})]})]}),e.jsx("div",{className:"flex gap-2",children:Object.entries(P).map(([a,v])=>e.jsx("button",{type:"button",onClick:()=>R(a),className:`flex-1 rounded-lg border px-3 py-2 text-xs font-medium transition ${p===a?"border-[var(--accent)] bg-[var(--accent)]/10":"border-[var(--line)] hover:border-[var(--accent)]/50"}`,style:{color:p===a?"var(--accent)":"var(--text)"},children:v.name},a))}),n&&e.jsx("div",{className:"rounded-lg border px-3 py-2 text-xs",style:{borderColor:"var(--error)",background:"var(--error)/10",color:"var(--error)"},children:n}),e.jsxs(f,{title:"Position Limits",children:[e.jsx(b,{label:"Max % of portfolio in single asset",value:s.maxPositionPercent,min:1,max:100,step:1,unit:"%",onChange:a=>d("maxPositionPercent",a)}),e.jsx(h,{label:"Max position value",value:s.maxPositionValueUsd,onChange:a=>d("maxPositionValueUsd",a)})]}),e.jsxs(f,{title:"Daily Limits",children:[e.jsx(h,{label:"Max daily trading volume",value:s.maxDailyVolumeUsd,onChange:a=>d("maxDailyVolumeUsd",a)}),e.jsx(h,{label:"Max daily loss (stop trading if reached)",value:s.maxDailyLossUsd,hint:"Trading will pause for the day if losses exceed this",onChange:a=>d("maxDailyLossUsd",a)})]}),e.jsxs(f,{title:"Transaction Limits",children:[e.jsx(h,{label:"Max single transaction",value:s.maxSingleTxUsd,onChange:a=>d("maxSingleTxUsd",a)}),e.jsx(h,{label:"Require approval above",value:s.requireApprovalAboveUsd,hint:"Transactions above this require manual confirmation",onChange:a=>d("requireApprovalAboveUsd",a)})]}),e.jsxs(f,{title:"Advanced Settings",defaultOpen:!1,children:[e.jsx(b,{label:"Max slippage tolerance",value:s.maxSlippagePercent,min:.1,max:10,step:.1,unit:"%",onChange:a=>d("maxSlippagePercent",a)}),e.jsx(b,{label:"Warn slippage above",value:s.warnSlippagePercent,min:.1,max:s.maxSlippagePercent-.1,step:.1,unit:"%",onChange:a=>d("warnSlippagePercent",a)}),e.jsx(b,{label:"Max gas as % of transaction",value:s.maxGasPercent,min:.1,max:20,step:.1,unit:"%",onChange:a=>d("maxGasPercent",a)}),e.jsx(b,{label:"Warn gas above",value:s.warnGasPercent,min:.1,max:s.maxGasPercent-.1,step:.1,unit:"%",onChange:a=>d("warnGasPercent",a)}),e.jsx(h,{label:"Minimum pool liquidity",value:s.minLiquidityUsd,hint:"Skip trades in pools with less liquidity",onChange:a=>d("minLiquidityUsd",a)})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-xl border px-4 py-3",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:"Enable Risk Policies"}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Apply these limits to all trading activity"})]}),e.jsx("button",{type:"button",onClick:()=>d("enabled",!s.enabled),className:`relative h-6 w-11 rounded-full transition ${s.enabled?"bg-[var(--accent)]":"bg-[var(--surface-3)]"}`,children:e.jsx("span",{className:`absolute top-0.5 h-5 w-5 rounded-full bg-white shadow transition ${s.enabled?"left-5":"left-0.5"}`})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button",onClick:x,disabled:!t,className:"flex items-center gap-1.5 rounded-lg border px-3 py-2 text-xs font-medium transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text-muted)",opacity:t?1:.5,cursor:t?"pointer":"not-allowed"},children:[e.jsx(T,{className:"h-3.5 w-3.5"}),"Remove Policy"]}),e.jsxs("button",{type:"button",onClick:U,disabled:!k||r,className:`ml-auto flex items-center gap-1.5 rounded-lg px-4 py-2 text-xs font-medium transition ${k&&!r?"bg-[var(--accent)] text-white hover:opacity-90":"bg-[var(--surface-3)] text-[var(--text-muted)] cursor-not-allowed"}`,children:[e.jsx(V,{className:"h-3.5 w-3.5"}),r?"Saving...":"Save Preferences"]})]}),!t&&e.jsx("p",{className:"text-center text-xs",style:{color:"var(--text-muted)"},children:"No policy set yet. Save to create your policy."})]})}function g({label:o,value:t,status:r}){return e.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:o}),e.jsxs("span",{className:"text-xs font-medium flex items-center gap-1",style:{color:r==="warning"?"var(--warning)":"var(--text)"},children:[t,r==="ok"&&e.jsx(F,{className:"h-3 w-3",style:{color:"var(--success)"}}),r==="warning"&&e.jsx(w,{className:"h-3 w-3"})]})]})}function I({widget:o,walletAddress:t}){const[r,l]=m.useState(!1),{config:x,hasPolicy:u,isLoading:s,save:i,reset:p,applyPreset:y}=L({walletAddress:t}),n=x??D;return t?s?e.jsxs("div",{className:"animate-pulse space-y-3 p-4",children:[e.jsx("div",{className:"h-10 rounded-lg",style:{background:"var(--surface-3)"}}),e.jsx("div",{className:"h-24 rounded-lg",style:{background:"var(--surface-3)"}}),e.jsx("div",{className:"h-8 rounded-lg",style:{background:"var(--surface-3)"}})]}):r?e.jsxs("div",{className:"p-4",children:[e.jsx($,{config:n,hasPolicy:u,onSave:async c=>{await i(c),l(!1)},onReset:p,onApplyPreset:y}),e.jsx("button",{type:"button",onClick:()=>l(!1),className:"mt-4 w-full rounded-lg border py-2 text-xs font-medium transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text-muted)"},children:"Cancel"})]}):u?e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl",style:{background:n.enabled?"var(--accent)/10":"var(--surface-3)"},children:e.jsx(N,{className:"h-5 w-5",style:{color:n.enabled?"var(--accent)":"var(--text-muted)"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:"Risk Policy"}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:n.enabled?"Active":"Disabled"})]})]}),e.jsxs("button",{type:"button",onClick:()=>l(!0),className:"flex items-center gap-1 rounded-lg border px-2.5 py-1.5 text-xs font-medium transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text)"},children:[e.jsx(O,{className:"h-3.5 w-3.5"}),"Edit"]})]}),e.jsxs("div",{className:"rounded-xl border divide-y",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(g,{label:"Max single transaction",value:j(n.maxSingleTxUsd),status:"ok"})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(g,{label:"Daily volume limit",value:j(n.maxDailyVolumeUsd),status:"ok"})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(g,{label:"Max position size",value:`${n.maxPositionPercent}%`,status:"ok"})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(g,{label:"Approval required above",value:j(n.requireApprovalAboveUsd)})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(g,{label:"Max slippage",value:`${n.maxSlippagePercent}%`,status:n.maxSlippagePercent>3?"warning":"ok"})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["conservative","moderate","aggressive"].map(c=>e.jsx("button",{type:"button",onClick:()=>y(c),className:"rounded-lg border px-2 py-1.5 text-[11px] font-medium capitalize transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text-muted)"},children:c},c))}),!n.enabled&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border px-3 py-2",style:{borderColor:"var(--warning)",background:"var(--warning)/5"},children:[e.jsx(w,{className:"h-4 w-4",style:{color:"var(--warning)"}}),e.jsx("p",{className:"text-xs",style:{color:"var(--warning)"},children:"Risk policies are disabled. Your trades will not be protected."})]})]}):e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-xl border p-4",style:{borderColor:"var(--warning)",background:"var(--warning)/5"},children:[e.jsx(w,{className:"h-5 w-5",style:{color:"var(--warning)"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:"No risk policy configured"}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Draft a policy to enable autonomous execution."})]})]}),e.jsx("button",{type:"button",onClick:()=>l(!0),className:"w-full rounded-lg border px-3 py-2 text-xs font-medium transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text)"},children:"Create Policy"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 rounded-xl border p-6 text-center",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsx(N,{className:"h-8 w-8",style:{color:"var(--text-muted)"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:"Connect Wallet"}),e.jsx("p",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:"Connect your wallet to configure risk policies"})]})]})}export{I as RiskPolicyWidget};
