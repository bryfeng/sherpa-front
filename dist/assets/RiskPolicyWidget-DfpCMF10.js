import{d9 as k,dd as x,d6 as e,d7 as P,e8 as q}from"./index-B8UX-kGC.js";import{C as E,u as D}from"./useRiskPolicy-Dq-mvTmK.js";import{a as S,f as j}from"./policy-BUGY-p8W.js";import{S as N}from"./shield--DopWFue.js";import{C as L}from"./chevron-down-BThiPcGt.js";import{S as F}from"./settings-Dwa3vBI5.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=k("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=k("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function g({title:o,children:l,defaultOpen:t=!0}){const[n,r]=x.useState(t);return e.jsxs("div",{className:"border rounded-xl",style:{borderColor:"var(--line)"},children:[e.jsxs("button",{type:"button",onClick:()=>r(!n),className:"flex w-full items-center justify-between px-4 py-3 text-left",children:[e.jsx("span",{className:"text-sm font-medium",style:{color:"var(--text)"},children:o}),n?e.jsx(L,{className:"h-4 w-4",style:{color:"var(--text-muted)"}}):e.jsx(E,{className:"h-4 w-4",style:{color:"var(--text-muted)"}})]}),n&&e.jsx("div",{className:"border-t px-4 pb-4 pt-3 space-y-4",style:{borderColor:"var(--line)"},children:l})]})}function y({label:o,value:l,min:t,max:n,step:r=1,unit:d="",hint:a,onChange:i}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:o}),e.jsxs("span",{className:"text-sm font-medium",style:{color:"var(--text)"},children:[l,d]})]}),e.jsx("input",{type:"range",min:t,max:n,step:r,value:l,onChange:p=>i(parseFloat(p.target.value)),className:"w-full h-2 rounded-full appearance-none cursor-pointer",style:{background:`linear-gradient(to right, var(--accent) 0%, var(--accent) ${(l-t)/(n-t)*100}%, var(--surface-3) ${(l-t)/(n-t)*100}%, var(--surface-3) 100%)`}}),a&&e.jsx("p",{className:"text-[11px]",style:{color:"var(--text-muted)"},children:a})]})}function h({label:o,value:l,hint:t,onChange:n}){const[r,d]=x.useState(l.toString());x.useEffect(()=>{d(l.toString())},[l]);const a=()=>{const i=parseFloat(r.replace(/[^0-9.]/g,""));!isNaN(i)&&i>=0?n(i):d(l.toString())};return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:o}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm",style:{color:"var(--text-muted)"},children:"$"}),e.jsx("input",{type:"text",value:r,onChange:i=>d(i.target.value),onBlur:a,className:"w-full rounded-lg border py-2 pl-7 pr-3 text-sm",style:{borderColor:"var(--line)",background:"var(--surface-2)",color:"var(--text)"}})]}),t&&e.jsx("p",{className:"text-[11px]",style:{color:"var(--text-muted)"},children:t})]})}function $({config:o,isDefault:l,isSaving:t=!1,onSave:n,onReset:r,onApplyPreset:d}){const[a,i]=x.useState(o),[p,f]=x.useState(null),[u,v]=x.useState(null);x.useEffect(()=>{i(o)},[o]),x.useEffect(()=>{for(const[s,m]of Object.entries(S))if(Object.entries(m.config).every(([M,A])=>a[M]===A)){f(s);return}f(null)},[a]);const c=x.useCallback((s,m)=>{i(w=>({...w,[s]:m})),v(null)},[]),U=async()=>{if(a.warnSlippagePercent>=a.maxSlippagePercent){v("Warn slippage must be less than max slippage");return}if(a.warnGasPercent>=a.maxGasPercent){v("Warn gas must be less than max gas");return}if(a.requireApprovalAboveUsd>a.maxSingleTxUsd){v("Approval threshold cannot exceed max transaction limit");return}try{await n(a)}catch(s){v(s instanceof Error?s.message:"Failed to save")}},R=async s=>{try{await d(s)}catch(m){v(m instanceof Error?m.message:"Failed to apply preset")}},C=JSON.stringify(a)!==JSON.stringify(o);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl",style:{background:"var(--surface-2)"},children:e.jsx(N,{className:"h-5 w-5",style:{color:"var(--accent)"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold",style:{color:"var(--text)"},children:"Trading Risk Preferences"}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Configure limits to protect your portfolio"})]})]}),e.jsx("div",{className:"flex gap-2",children:Object.entries(S).map(([s,m])=>e.jsx("button",{type:"button",onClick:()=>R(s),className:`flex-1 rounded-lg border px-3 py-2 text-xs font-medium transition ${p===s?"border-[var(--accent)] bg-[var(--accent)]/10":"border-[var(--line)] hover:border-[var(--accent)]/50"}`,style:{color:p===s?"var(--accent)":"var(--text)"},children:m.name},s))}),u&&e.jsx("div",{className:"rounded-lg border px-3 py-2 text-xs",style:{borderColor:"var(--error)",background:"var(--error)/10",color:"var(--error)"},children:u}),e.jsxs(g,{title:"Position Limits",children:[e.jsx(y,{label:"Max % of portfolio in single asset",value:a.maxPositionPercent,min:1,max:100,step:1,unit:"%",onChange:s=>c("maxPositionPercent",s)}),e.jsx(h,{label:"Max position value",value:a.maxPositionValueUsd,onChange:s=>c("maxPositionValueUsd",s)})]}),e.jsxs(g,{title:"Daily Limits",children:[e.jsx(h,{label:"Max daily trading volume",value:a.maxDailyVolumeUsd,onChange:s=>c("maxDailyVolumeUsd",s)}),e.jsx(h,{label:"Max daily loss (stop trading if reached)",value:a.maxDailyLossUsd,hint:"Trading will pause for the day if losses exceed this",onChange:s=>c("maxDailyLossUsd",s)})]}),e.jsxs(g,{title:"Transaction Limits",children:[e.jsx(h,{label:"Max single transaction",value:a.maxSingleTxUsd,onChange:s=>c("maxSingleTxUsd",s)}),e.jsx(h,{label:"Require approval above",value:a.requireApprovalAboveUsd,hint:"Transactions above this require manual confirmation",onChange:s=>c("requireApprovalAboveUsd",s)})]}),e.jsxs(g,{title:"Advanced Settings",defaultOpen:!1,children:[e.jsx(y,{label:"Max slippage tolerance",value:a.maxSlippagePercent,min:.1,max:10,step:.1,unit:"%",onChange:s=>c("maxSlippagePercent",s)}),e.jsx(y,{label:"Warn slippage above",value:a.warnSlippagePercent,min:.1,max:a.maxSlippagePercent-.1,step:.1,unit:"%",onChange:s=>c("warnSlippagePercent",s)}),e.jsx(y,{label:"Max gas as % of transaction",value:a.maxGasPercent,min:.1,max:20,step:.1,unit:"%",onChange:s=>c("maxGasPercent",s)}),e.jsx(y,{label:"Warn gas above",value:a.warnGasPercent,min:.1,max:a.maxGasPercent-.1,step:.1,unit:"%",onChange:s=>c("warnGasPercent",s)}),e.jsx(h,{label:"Minimum pool liquidity",value:a.minLiquidityUsd,hint:"Skip trades in pools with less liquidity",onChange:s=>c("minLiquidityUsd",s)})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-xl border px-4 py-3",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:"Enable Risk Policies"}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Apply these limits to all trading activity"})]}),e.jsx("button",{type:"button",onClick:()=>c("enabled",!a.enabled),className:`relative h-6 w-11 rounded-full transition ${a.enabled?"bg-[var(--accent)]":"bg-[var(--surface-3)]"}`,children:e.jsx("span",{className:`absolute top-0.5 h-5 w-5 rounded-full bg-white shadow transition ${a.enabled?"left-5":"left-0.5"}`})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button",onClick:r,className:"flex items-center gap-1.5 rounded-lg border px-3 py-2 text-xs font-medium transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text-muted)"},children:[e.jsx(T,{className:"h-3.5 w-3.5"}),"Reset to Defaults"]}),e.jsxs("button",{type:"button",onClick:U,disabled:!C||t,className:`ml-auto flex items-center gap-1.5 rounded-lg px-4 py-2 text-xs font-medium transition ${C&&!t?"bg-[var(--accent)] text-white hover:opacity-90":"bg-[var(--surface-3)] text-[var(--text-muted)] cursor-not-allowed"}`,children:[e.jsx(V,{className:"h-3.5 w-3.5"}),t?"Saving...":"Save Preferences"]})]}),l&&e.jsx("p",{className:"text-center text-xs",style:{color:"var(--text-muted)"},children:"Using default settings. Save to create your custom policy."})]})}function b({label:o,value:l,status:t}){return e.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:o}),e.jsxs("span",{className:"text-xs font-medium flex items-center gap-1",style:{color:t==="warning"?"var(--warning)":"var(--text)"},children:[l,t==="ok"&&e.jsx(q,{className:"h-3 w-3",style:{color:"var(--success)"}}),t==="warning"&&e.jsx(P,{className:"h-3 w-3"})]})]})}function H({artifact:o,walletAddress:l}){const[t,n]=x.useState(!1),{config:r,isDefault:d,isLoading:a,save:i,reset:p,applyPreset:f}=D({walletAddress:l});return l?a?e.jsxs("div",{className:"animate-pulse space-y-3 p-4",children:[e.jsx("div",{className:"h-10 rounded-lg",style:{background:"var(--surface-3)"}}),e.jsx("div",{className:"h-24 rounded-lg",style:{background:"var(--surface-3)"}}),e.jsx("div",{className:"h-8 rounded-lg",style:{background:"var(--surface-3)"}})]}):t?e.jsxs("div",{className:"p-4",children:[e.jsx($,{config:r,isDefault:d,onSave:async u=>{await i(u),n(!1)},onReset:p,onApplyPreset:f}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"mt-4 w-full rounded-lg border py-2 text-xs font-medium transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text-muted)"},children:"Cancel"})]}):e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl",style:{background:r.enabled?"var(--accent)/10":"var(--surface-3)"},children:e.jsx(N,{className:"h-5 w-5",style:{color:r.enabled?"var(--accent)":"var(--text-muted)"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:"Risk Policy"}),e.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[r.enabled?"Active":"Disabled",d&&" (defaults)"]})]})]}),e.jsxs("button",{type:"button",onClick:()=>n(!0),className:"flex items-center gap-1 rounded-lg border px-2.5 py-1.5 text-xs font-medium transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text)"},children:[e.jsx(F,{className:"h-3.5 w-3.5"}),"Edit"]})]}),e.jsxs("div",{className:"rounded-xl border divide-y",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(b,{label:"Max single transaction",value:j(r.maxSingleTxUsd),status:"ok"})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(b,{label:"Daily volume limit",value:j(r.maxDailyVolumeUsd),status:"ok"})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(b,{label:"Max position size",value:`${r.maxPositionPercent}%`,status:"ok"})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(b,{label:"Approval required above",value:j(r.requireApprovalAboveUsd)})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(b,{label:"Max slippage",value:`${r.maxSlippagePercent}%`,status:r.maxSlippagePercent>3?"warning":"ok"})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["conservative","moderate","aggressive"].map(u=>e.jsx("button",{type:"button",onClick:()=>f(u),className:"rounded-lg border px-2 py-1.5 text-[11px] font-medium capitalize transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text-muted)"},children:u},u))}),!r.enabled&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border px-3 py-2",style:{borderColor:"var(--warning)",background:"var(--warning)/5"},children:[e.jsx(P,{className:"h-4 w-4",style:{color:"var(--warning)"}}),e.jsx("p",{className:"text-xs",style:{color:"var(--warning)"},children:"Risk policies are disabled. Your trades will not be protected."})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 rounded-xl border p-6 text-center",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsx(N,{className:"h-8 w-8",style:{color:"var(--text-muted)"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:"Connect Wallet"}),e.jsx("p",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:"Connect your wallet to configure risk policies"})]})]})}export{H as RiskPolicyWidget};
