import{da as h,db as r,dc as c,dd as a}from"./index-rkOzlyuE.js";function I({walletAddress:o,includeExpired:x=!1,includeRevoked:A=!1}){const i=h(r.sessionKeys.listByWallet,o?{walletAddress:o,includeExpired:x,includeRevoked:A}:"skip"),d=c(r.sessionKeys.create),m=c(r.sessionKeys.revoke),v=c(r.sessionKeys.extend),e=a.useMemo(()=>i?i.map(t=>({sessionId:t.sessionId,walletAddress:t.walletAddress,agentId:t.agentId??void 0,permissions:t.permissions,maxValuePerTxUsd:parseFloat(t.valueLimits.maxValuePerTxUsd),maxTotalValueUsd:parseFloat(t.valueLimits.maxTotalValueUsd),totalValueUsedUsd:parseFloat(t.valueLimits.totalValueUsedUsd),transactionCount:t.valueLimits.transactionCount,maxTransactions:t.valueLimits.maxTransactions,chainAllowlist:t.chainAllowlist,tokenAllowlist:t.tokenAllowlist,contractAllowlist:t.contractAllowlist,status:t.status,expiresAt:t.expiresAt,createdAt:t.createdAt,lastUsedAt:t.lastUsedAt??void 0,revokedAt:t.revokedAt??void 0,revokeReason:t.revokeReason??void 0})):[],[i]),k=a.useMemo(()=>{const t=Date.now();return e.filter(s=>s.status==="active"&&s.expiresAt>t).length},[e]),w=i===void 0&&o!==void 0,p=a.useCallback(async t=>{if(!o)throw new Error("Wallet address required to create session");const s=`sk_${Date.now()}_${Math.random().toString(36).slice(2,9)}`;return await d({sessionId:s,walletAddress:o,permissions:t.permissions,valueLimits:{maxValuePerTxUsd:t.valueLimits.maxValuePerTxUsd.toString(),maxTotalValueUsd:t.valueLimits.maxTotalValueUsd.toString(),maxTransactions:t.valueLimits.maxTransactions,totalValueUsedUsd:"0",transactionCount:0},chainAllowlist:t.chainAllowlist,contractAllowlist:t.contractAllowlist,tokenAllowlist:t.tokenAllowlist,createdAt:Date.now(),expiresAt:t.expiresAt,status:"active"}),s},[o,d]),U=a.useCallback(async(t,s)=>{await m({sessionId:t,revokedAt:Date.now(),revokeReason:s})},[m]),T=a.useCallback(async(t,s)=>{await v({sessionId:t,additionalDays:s})},[v]),V=a.useCallback(t=>e.find(s=>s.sessionId===t),[e]),y=a.useCallback(t=>{const s=e.find(L=>L.sessionId===t);if(!s)return;const l=s.totalValueUsedUsd,n=s.maxTotalValueUsd,u=n>0?l/n*100:0;return{used:l,total:n,percent:u}},[e]),C=a.useCallback(t=>{const s=e.find(u=>u.sessionId===t);if(!s)return;const l=Date.now(),n=s.expiresAt-l;return Math.max(0,Math.ceil(n/(24*60*60*1e3)))},[e]);return{sessions:e,activeCount:k,isLoading:w,create:p,revoke:U,extend:T,getSession:V,getBudgetUsage:y,getDaysRemaining:C}}export{I as u};
