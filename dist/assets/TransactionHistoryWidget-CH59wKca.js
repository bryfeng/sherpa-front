import{dM as u,eb as v,ec as g,dU as x,ed as y,dO as e,ee as i,dP as o,ef as j,eg as N,eh as p,ei as w,dQ as m,ej as b,ek as k}from"./index-DkD0KfRO.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=u("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d=u("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);function C(t,a=20){const s=v(g.transactions.getRecentActivity,t?{walletAddress:t,limit:a}:"skip"),n=x.useMemo(()=>{if(!s)return[];const l=(s.transactions||[]).map(r=>({id:`tx-${r._id}`,type:"transaction",timestamp:r.createdAt,data:r})),c=(s.executions||[]).map(r=>({id:`exec-${r._id}`,type:"execution",timestamp:r.createdAt||r._creationTime,data:r}));return[...l,...c].sort((r,f)=>f.timestamp-r.timestamp)},[s]);return{items:n,transactions:(s==null?void 0:s.transactions)||[],executions:(s==null?void 0:s.executions)||[],isLoading:s===void 0,isEmpty:s!==void 0&&n.length===0}}function A(t){return{swap:"Swap",bridge:"Bridge",transfer:"Transfer",approve:"Approval"}[t]||t}function T(t){return{pending:"Pending",submitted:"Submitted",confirmed:"Confirmed",failed:"Failed",reverted:"Reverted"}[t]||t}function E(t){return{idle:"Idle",analyzing:"Analyzing",planning:"Planning",awaiting_approval:"Awaiting Approval",executing:"Executing",monitoring:"Monitoring",completed:"Completed",failed:"Failed",paused:"Paused",cancelled:"Cancelled"}[t]||t}function R(t){return{pending:"var(--warning)",submitted:"var(--accent)",confirmed:"var(--success)",failed:"var(--error)",reverted:"var(--error)"}[t]||"var(--text-muted)"}function $(t){return{idle:"var(--text-muted)",analyzing:"var(--accent)",planning:"var(--accent)",awaiting_approval:"var(--warning)",executing:"var(--accent)",monitoring:"var(--accent)",completed:"var(--success)",failed:"var(--error)",paused:"var(--warning)",cancelled:"var(--text-muted)"}[t]||"var(--text-muted)"}function h(t){const s=Date.now()-t;return s<6e4?"Just now":s<36e5?`${Math.round(s/6e4)}m ago`:s<864e5?`${Math.round(s/36e5)}h ago`:s<6048e5?`${Math.round(s/864e5)}d ago`:new Date(t).toLocaleDateString()}function _(t){return t==null?"-":`$${t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}function I(t){return t?`${t.slice(0,6)}...${t.slice(-4)}`:"-"}function L(t,a){const s={ethereum:"https://etherscan.io/tx/",base:"https://basescan.org/tx/",arbitrum:"https://arbiscan.io/tx/",optimism:"https://optimistic.etherscan.io/tx/",polygon:"https://polygonscan.com/tx/"};return`${s[a.toLowerCase()]||s.ethereum}${t}`}const M=[{value:"all",label:"All Activity"},{value:"transactions",label:"Transactions"},{value:"executions",label:"Executions"}],U={swap:e.jsx(p,{className:"h-4 w-4"}),bridge:e.jsx(b,{className:"h-4 w-4"}),transfer:e.jsx(S,{className:"h-4 w-4"}),approve:e.jsx(d,{className:"h-4 w-4"})};function Y(){const{address:t}=y(),[a,s]=x.useState("all"),{items:n,isLoading:l}=C(t??null,50),c=n.filter(r=>a==="all"?!0:a==="transactions"?r.type==="transaction":a==="executions"?r.type==="execution":!0);return t?e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"shrink-0 px-4 pt-4 pb-3",style:{borderBottom:"1px solid var(--line)"},children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text)"},children:"Activity"}),e.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[c.length," ",a==="all"?"items":a]})]})}),e.jsx("div",{className:"flex gap-1 p-1 rounded-lg",style:{background:"var(--surface-2)"},children:M.map(r=>e.jsx("button",{onClick:()=>s(r.value),className:"flex-1 px-3 py-1.5 rounded-md text-xs font-medium transition-colors",style:{background:a===r.value?"var(--surface)":"transparent",color:a===r.value?"var(--text)":"var(--text-muted)",boxShadow:a===r.value?"0 1px 2px rgba(0,0,0,0.1)":"none"},children:r.label},r.value))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:l?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(o,{className:"h-6 w-6 animate-spin",style:{color:"var(--accent)"}})}):c.length===0?e.jsx(D,{filter:a}):e.jsx("div",{className:"divide-y",style:{borderColor:"var(--line)"},children:e.jsx(j,{mode:"popLayout",children:c.map(r=>e.jsx(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},layout:!0,children:r.type==="transaction"?e.jsx(P,{transaction:r.data}):e.jsx(z,{execution:r.data})},r.id))})})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[e.jsx(i,{className:"h-12 w-12 mb-4",style:{color:"var(--text-muted)"}}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Connect your wallet to view transaction history."})]})}function D({filter:t}){const a={all:{title:"No Activity Yet",description:"Your transactions and strategy executions will appear here."},transactions:{title:"No Transactions",description:"On-chain transactions like swaps, bridges, and transfers will appear here."},executions:{title:"No Executions",description:"Strategy executions from your automated strategies will appear here."}},{title:s,description:n}=a[t];return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mb-4",style:{background:"var(--surface-2)"},children:e.jsx(i,{className:"h-8 w-8",style:{color:"var(--text-muted)"}})}),e.jsx("h3",{className:"font-medium mb-1",style:{color:"var(--text)"},children:s}),e.jsx("p",{className:"text-sm max-w-xs",style:{color:"var(--text-muted)"},children:n})]})}function P({transaction:t}){const a=R(t.status),s=U[t.type]||e.jsx(p,{className:"h-4 w-4"});return e.jsx("div",{className:"px-4 py-3 hover:bg-black/5 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center shrink-0",style:{background:"var(--surface-2)",color:"var(--text)"},children:s}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium text-sm",style:{color:"var(--text)"},children:A(t.type)}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:h(t.createdAt)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 mt-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs",style:{background:`${a}20`,color:a},children:[e.jsx(F,{status:t.status}),T(t.status)]}),e.jsx("span",{className:"text-xs capitalize",style:{color:"var(--text-muted)"},children:t.chain})]}),t.valueUsd!==void 0&&e.jsx("span",{className:"text-sm font-medium",style:{color:"var(--text)"},children:_(t.valueUsd)})]}),t.txHash&&e.jsxs("a",{href:L(t.txHash,t.chain),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 mt-1.5 text-xs hover:underline",style:{color:"var(--accent)"},children:[I(t.txHash),e.jsx(w,{className:"h-3 w-3"})]})]})]})})}function z({execution:t}){var n,l;const a=$(t.currentState),s=["completed","failed","cancelled"].includes(t.currentState);return e.jsx("div",{className:"px-4 py-3 hover:bg-black/5 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center shrink-0",style:{background:"var(--accent-muted)",color:"var(--accent)"},children:s?t.currentState==="completed"?e.jsx(d,{className:"h-4 w-4"}):e.jsx(m,{className:"h-4 w-4"}):e.jsx(o,{className:"h-4 w-4 animate-spin"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium text-sm truncate",style:{color:"var(--text)"},children:((n=t.strategy)==null?void 0:n.name)||"Strategy Execution"}),e.jsx("span",{className:"text-xs shrink-0",style:{color:"var(--text-muted)"},children:h(t.createdAt||t._creationTime)})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs",style:{background:`${a}20`,color:a},children:[e.jsx(H,{state:t.currentState}),E(t.currentState)]}),((l=t.strategy)==null?void 0:l.strategyType)&&e.jsx("span",{className:"text-xs uppercase",style:{color:"var(--text-muted)"},children:t.strategy.strategyType})]}),t.errorMessage&&e.jsx("p",{className:"mt-1.5 text-xs truncate",style:{color:"var(--error)"},title:t.errorMessage,children:t.errorMessage}),t.currentState==="awaiting_approval"&&t.approvalReason&&e.jsx("p",{className:"mt-1.5 text-xs truncate",style:{color:"var(--warning)"},children:t.approvalReason})]})]})})}function F({status:t}){switch(t){case"pending":return e.jsx(i,{className:"h-3 w-3"});case"submitted":return e.jsx(o,{className:"h-3 w-3 animate-spin"});case"confirmed":return e.jsx(d,{className:"h-3 w-3"});case"failed":case"reverted":return e.jsx(m,{className:"h-3 w-3"});default:return null}}function H({state:t}){switch(t){case"completed":return e.jsx(d,{className:"h-3 w-3"});case"failed":case"cancelled":return e.jsx(m,{className:"h-3 w-3"});case"awaiting_approval":return e.jsx(k,{className:"h-3 w-3"});case"executing":case"monitoring":case"analyzing":case"planning":return e.jsx(o,{className:"h-3 w-3 animate-spin"});default:return e.jsx(i,{className:"h-3 w-3"})}}export{Y as TransactionHistoryWidget};
