import{d9 as se,d6 as e,dU as Le,ei as be,dV as T,d7 as Ce,dd as ve,e1 as qe}from"./index-Dide1ZUj.js";import{E as Re}from"./ErrorView-CLxdsBZc.js";import{C as $e}from"./circle-x-D1FfFPr5.js";import{C as Se,u as Ve,a as ye,b as we,c as De}from"./usePolicyStatus-BCvNUQu7.js";import{C as Te}from"./chevron-down-DMOhZkTO.js";import{a as Be,C as je}from"./useRiskPolicy-Bc1Sfk42.js";import{u as Fe}from"./useSessionKeys-CJFcsIpj.js";import{c as y,d as O,e as P,f as x}from"./policy-BUGY-p8W.js";import{M as We}from"./maximize-2-BzG202NT.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=se("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=se("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=se("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]),Ge="inline-flex items-center gap-2 rounded-full border border-[var(--line)] bg-[var(--surface-2)] px-3 py-1 text-[11px] font-semibold text-[var(--text)] transition hover:bg-[var(--hover)]",Ne={section:"rounded-2xl border border-[var(--line)] bg-[var(--surface)] p-4 text-[var(--text)] shadow-sm",statCard:"rounded-2xl border border-[var(--line)] bg-[var(--surface-2)] p-4 space-y-1 text-[var(--text)]",statLabel:"text-[10px] uppercase tracking-[0.24em] text-[var(--text-muted)]",statValue:"text-lg font-semibold text-[var(--text)]",statHelper:"text-xs text-[var(--text-muted)]",helper:"text-[var(--text-muted)]",chip:{base:Ge,active:"bg-[var(--accent)] text-[var(--text-inverse)] border-transparent shadow-sm hover:bg-[var(--accent-600)]"},metaChip:"inline-flex items-center gap-1 rounded-full border border-[var(--line)] bg-[var(--surface-2)] px-3 py-1 text-[10px] font-medium text-[var(--text-muted)]",summaryCard:"rounded-2xl border border-[var(--line)] bg-[var(--surface-2)] px-4 py-3 text-xs text-[var(--text)] flex items-center justify-between gap-3",summaryValue:"font-mono text-sm text-[var(--text)] truncate",toggle:"inline-flex items-center gap-1 rounded-full border border-[var(--line)] bg-[var(--surface-2)] px-2.5 py-1 text-[11px] font-semibold text-[var(--text-muted)] transition hover:bg-[var(--hover)]",promptPill:"inline-flex items-center gap-2 rounded-full border border-[var(--line)] bg-[var(--surface-2)] px-3 py-1.5 text-xs font-semibold text-[var(--text)] hover:bg-[var(--hover)]",actionPrimary:"inline-flex items-center justify-center gap-2 rounded-full bg-[var(--accent)] px-5 py-2.5 text-sm font-semibold text-[var(--text-inverse)] shadow-sm transition hover:bg-[var(--accent-600)] disabled:cursor-not-allowed disabled:opacity-60",actionSecondary:"inline-flex items-center justify-center gap-2 rounded-full border border-[var(--line)] bg-[var(--surface-2)] px-5 py-2.5 text-sm font-semibold text-[var(--text)] transition hover:bg-[var(--hover)] disabled:cursor-not-allowed disabled:opacity-60",ghostAction:"inline-flex items-center justify-center gap-2 rounded-full border border-transparent bg-transparent px-3 py-1 text-xs font-semibold text-[var(--text-muted)] hover:bg-[var(--hover)] disabled:cursor-not-allowed disabled:opacity-40",warningSection:"rounded-2xl border border-[rgba(255,204,102,.35)] bg-[rgba(255,204,102,.12)] p-4 text-xs text-[var(--warning)]",errorText:"text-[var(--danger)]",successText:"text-[var(--success)]"},He={swap:{container:"relative rounded-[24px] border border-[var(--line)] bg-[var(--surface)] p-5 text-[var(--text)] shadow-lg overflow-hidden",border:"border-[var(--line)]",overlays:["absolute -left-16 top-12 h-48 w-48 rounded-full bg-[rgba(90,164,255,.18)] blur-[80px]","absolute right-[-40px] top-14 h-44 w-44 rounded-full bg-[rgba(41,127,240,.16)] blur-[70px]","absolute bottom-[-60px] left-24 h-60 w-60 rounded-full bg-[rgba(90,164,255,.12)] blur-[100px]"],label:"text-[var(--text-muted)]",accent:{positive:"text-[var(--success)]",negative:"text-[var(--danger)]",neutral:"text-[var(--text)]"},...Ne},bridge:{container:"relative rounded-[24px] border border-[var(--line)] bg-[var(--surface)] p-5 text-[var(--text)] shadow-lg overflow-hidden",border:"border-[var(--line)]",overlays:["absolute -left-20 top-10 h-52 w-52 rounded-full bg-[rgba(41,127,240,.18)] blur-[90px]","absolute right-[-50px] top-20 h-48 w-48 rounded-full bg-[rgba(90,164,255,.16)] blur-[80px]","absolute bottom-[-70px] left-28 h-64 w-64 rounded-full bg-[rgba(90,164,255,.12)] blur-[100px]"],label:"text-[var(--text-muted)]",accent:{positive:"text-[var(--success)]",negative:"text-[var(--danger)]",neutral:"text-[var(--text)]"},...Ne}},Ke={pass:{icon:Se,color:"var(--success)",bgColor:"var(--success)/10"},warn:{icon:Ce,color:"var(--warning)",bgColor:"var(--warning)/10"},fail:{icon:$e,color:"var(--error)",bgColor:"var(--error)/10"}};function ke({check:r,compact:s}){var a,f;const[n,c]=T.useState(!1),i=Ke[r.status],u=i.icon,o=r.details&&(r.details.current||r.details.limit);return s?e.jsxs("div",{className:"flex items-center gap-2 rounded-lg px-2 py-1",style:{background:i.bgColor},children:[e.jsx(u,{className:"h-3 w-3 flex-shrink-0",style:{color:i.color}}),e.jsx("span",{className:"text-xs truncate",style:{color:i.color},children:r.label})]}):e.jsxs("div",{className:"rounded-lg border transition-colors",style:{borderColor:r.status==="pass"?"var(--line)":i.color,background:r.status==="pass"?"transparent":i.bgColor},children:[e.jsxs("button",{type:"button",onClick:()=>o&&c(!n),className:"flex w-full items-center gap-2 px-3 py-2 text-left",disabled:!o,children:[e.jsx(u,{className:"h-4 w-4 flex-shrink-0",style:{color:i.color}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-xs font-medium",style:{color:"var(--text)"},children:r.label}),o&&e.jsx("span",{style:{color:"var(--text-muted)"},children:n?e.jsx(X,{className:"h-3.5 w-3.5"}):e.jsx(Te,{className:"h-3.5 w-3.5"})})]}),e.jsx("p",{className:"text-[11px] truncate",style:{color:"var(--text-muted)"},children:r.message})]})]}),n&&o&&e.jsx("div",{className:"border-t px-3 py-2",style:{borderColor:"var(--line)"},children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[10px]",children:[((a=r.details)==null?void 0:a.current)&&e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Current: "}),e.jsx("span",{className:"font-medium",style:{color:"var(--text)"},children:r.details.current})]}),((f=r.details)==null?void 0:f.limit)&&e.jsxs("div",{children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Limit: "}),e.jsx("span",{className:"font-medium",style:{color:"var(--text)"},children:r.details.limit})]})]})})]})}function Qe({result:r}){const{canProceed:s,blockingCount:n,warningCount:c,checks:i}=r,u=i.filter(o=>o.status==="pass").length;return n>0?e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full px-2.5 py-1",style:{background:"var(--error)/10"},children:[e.jsx($e,{className:"h-3.5 w-3.5",style:{color:"var(--error)"}}),e.jsxs("span",{className:"text-xs font-medium",style:{color:"var(--error)"},children:[n," blocking"]})]}):c>0?e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full px-2.5 py-1",style:{background:"var(--warning)/10"},children:[e.jsx(Ce,{className:"h-3.5 w-3.5",style:{color:"var(--warning)"}}),e.jsxs("span",{className:"text-xs font-medium",style:{color:"var(--warning)"},children:[c," warning",c>1?"s":""]})]}):e.jsxs("div",{className:"flex items-center gap-1.5 rounded-full px-2.5 py-1",style:{background:"var(--success)/10"},children:[e.jsx(Se,{className:"h-3.5 w-3.5",style:{color:"var(--success)"}}),e.jsxs("span",{className:"text-xs font-medium",style:{color:"var(--success)"},children:[u," passed"]})]})}function Xe({result:r,compact:s=!1,isLoading:n=!1}){const{checks:c,canProceed:i,blockingCount:u,warningCount:o}=r;if(n)return e.jsxs("div",{className:"flex items-center justify-center gap-2 rounded-xl border px-3 py-4",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsx(Le,{className:"h-4 w-4 animate-spin",style:{color:"var(--text-muted)"}}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Checking policies..."})]});if(c.length===0)return null;if(s){const m=c.filter(w=>w.status!=="pass");return m.length===0?e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(be,{className:"h-3.5 w-3.5",style:{color:"var(--success)"}}),e.jsx("span",{className:"text-xs",style:{color:"var(--success)"},children:"All checks pass"})]}):e.jsx("div",{className:"flex flex-wrap gap-1.5",children:m.map(w=>e.jsx(ke,{check:w,compact:!0},w.id))})}const a=c.filter(m=>m.status==="fail"),f=c.filter(m=>m.status==="warn"),b=c.filter(m=>m.status==="pass"),j=[...a,...f,...b];return e.jsxs("div",{className:"rounded-xl border",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-3 py-2.5",style:{borderColor:"var(--line)"},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4",style:{color:"var(--text-muted)"}}),e.jsx("span",{className:"text-xs font-medium",style:{color:"var(--text)"},children:"Policy Check"})]}),e.jsx(Qe,{result:r})]}),e.jsx("div",{className:"p-2 space-y-1.5",children:j.map(m=>e.jsx(ke,{check:m},m.id))}),!i&&e.jsx("div",{className:"border-t px-3 py-2",style:{borderColor:"var(--line)"},children:e.jsx("p",{className:"text-[10px]",style:{color:"var(--error)"},children:"Resolve blocking issues before proceeding"})})]})}function Je({walletAddress:r,intent:s}){const n=Be(r??void 0),{status:c,canTrade:i,statusMessage:u}=Ve(),{sessions:o}=Fe({walletAddress:r??void 0}),a=ye((s==null?void 0:s.fromToken.chainId)??1),f=ye((s==null?void 0:s.toToken.chainId)??1),b=we((s==null?void 0:s.fromToken.address)??""),j=we((s==null?void 0:s.toToken.address)??""),m=De((s==null?void 0:s.contractAddress)??""),w=ve.useMemo(()=>{const p=Date.now();return o.find(g=>g.status==="active"&&g.expiresAt>p)},[o]);return ve.useMemo(()=>{if(!r||!s)return{canProceed:!0,checks:[],blockingCount:0,warningCount:0};const p=[];c.emergencyStop?p.push(y("system-emergency","System status",u||"Trading is temporarily disabled")):c.inMaintenance?p.push(O("system-maintenance","System status",u||"Maintenance in progress")):p.push(P("system-status","System status","Operational")),a?s.type==="bridge"&&!f?p.push(y("chain-to-blocked","Destination chain",`Chain ${s.toToken.chainId} is not supported`)):p.push(P("chain-allowed","Chain allowed","Chain is supported")):p.push(y("chain-from-blocked","Source chain",`Chain ${s.fromToken.chainId} is not supported`)),b?p.push(y("token-from-blocked","Source token",`${s.fromToken.symbol} is blocked`)):j?p.push(y("token-to-blocked","Destination token",`${s.toToken.symbol} is blocked`)):p.push(P("token-allowed","Token allowed","Tokens are allowed")),s.contractAddress&&m&&p.push(y("contract-blocked","Contract","Transaction target contract is blocked"));const g=Ye(s,n);p.push(g);const V=Ze(s,n);p.push(V);const $=es(s,n);if(p.push($),w){const C=ss(s,w);p.push(...C)}const _=p.filter(C=>C.status==="fail").length,N=p.filter(C=>C.status==="warn").length;return{canProceed:_===0&&i,checks:p,blockingCount:_,warningCount:N}},[r,s,n,c,i,u,a,f,b,j,m,w])}function Ye(r,s){const{amountUsd:n}=r,{maxSingleTxUsd:c,requireApprovalAboveUsd:i}=s;return n>c?y("tx-limit","Transaction limit",`Exceeds ${x(c)} limit`,{current:x(n),limit:x(c)}):n>i?O("tx-limit","Transaction limit",`Above ${x(i)} approval threshold`,{current:x(n),limit:x(i)}):P("tx-limit","Transaction limit",`${x(n)} within limit`,{current:x(n),limit:x(c)})}function Ze(r,s){const{slippagePercent:n}=r,{maxSlippagePercent:c,warnSlippagePercent:i}=s,u=o=>`${o.toFixed(2)}%`;return n>c?y("slippage","Slippage",`${u(n)} exceeds ${u(c)} limit`,{current:u(n),limit:u(c)}):n>i?O("slippage","Slippage",`${u(n)} is high`,{current:u(n),limit:u(c)}):P("slippage","Slippage",`${u(n)} OK`,{current:u(n),limit:u(c)})}function es(r,s){const{gasEstimateUsd:n,amountUsd:c}=r,{maxGasPercent:i,warnGasPercent:u}=s,o=c>0?n/c*100:0,a=f=>`${f.toFixed(2)}%`;return o>i?y("gas-cost","Gas cost",`${a(o)} of transaction exceeds ${a(i)} limit`,{current:x(n),limit:a(i)}):o>u?O("gas-cost","Gas cost",`${a(o)} of transaction is high`,{current:x(n),limit:a(i)}):P("gas-cost","Gas cost",`${x(n)} (${a(o)}) OK`,{current:x(n),limit:a(i)})}function ss(r,s){const n=[],c=r.type;s.permissions.includes(c)?n.push(P("session-permission","Session permission",`"${c}" allowed`)):n.push(y("session-permission","Session permission",`Session doesn't have "${c}" permission`)),r.amountUsd>s.maxValuePerTxUsd&&n.push(y("session-tx-limit","Session tx limit",`Exceeds ${x(s.maxValuePerTxUsd)} per-transaction limit`,{current:x(r.amountUsd),limit:x(s.maxValuePerTxUsd)}));const u=s.maxTotalValueUsd-s.totalValueUsedUsd;if(r.amountUsd>u)n.push(y("session-budget","Session budget",`Exceeds remaining budget of ${x(u)}`,{current:x(r.amountUsd),limit:x(u)}));else{const o=(s.totalValueUsedUsd+r.amountUsd)/s.maxTotalValueUsd*100;o>80?n.push(O("session-budget","Session budget",`Will use ${o.toFixed(0)}% of session budget`,{current:x(s.totalValueUsedUsd+r.amountUsd),limit:x(s.maxTotalValueUsd)})):n.push(P("session-budget","Session budget",`${x(u)} remaining`,{current:x(r.amountUsd),limit:x(s.maxTotalValueUsd)}))}if(s.chainAllowlist.length>0&&(s.chainAllowlist.includes(r.fromToken.chainId)&&(r.type!=="bridge"||s.chainAllowlist.includes(r.toToken.chainId))||n.push(y("session-chain","Session chains","Chain not in session allowlist"))),s.tokenAllowlist.length>0){const o=`${r.fromToken.chainId}:${r.fromToken.address.toLowerCase()}`,a=`${r.toToken.chainId}:${r.toToken.address.toLowerCase()}`;s.tokenAllowlist.some(b=>b.toLowerCase()===o)&&s.tokenAllowlist.some(b=>b.toLowerCase()===a)||n.push(y("session-token","Session tokens","Token not in session allowlist"))}return n}function ts(r){var D,C,I,z;const s=r.payload||{},n=typeof s.quote_type=="string"?s.quote_type.toLowerCase():r.id==="relay_swap_quote"?"swap":"bridge",c=n==="swap"?"swap":n==="bridge"?"bridge":"transfer",i=s.input||s.from||{},u={address:String(i.address||((D=i.token)==null?void 0:D.address)||""),symbol:String(i.symbol||((C=i.token)==null?void 0:C.symbol)||"UNKNOWN"),chainId:Number(i.chainId||i.chain_id||s.chainId||s.chain_id||1)},o=s.output||s.to||{},a=s.breakdown||{},f=a.output||{},b={address:String(o.address||((I=o.token)==null?void 0:I.address)||""),symbol:String(f.symbol||o.symbol||((z=o.token)==null?void 0:z.symbol)||"UNKNOWN"),chainId:Number(o.chainId||o.chain_id||(c==="bridge"?s.destinationChainId||s.destination_chain_id:u.chainId)||u.chainId)},j=s.usd_estimates||{},m=Q(j.input||i.value_usd||i.usd_value),w=Q(j.output||f.value_usd||o.value_usd),p=m||w||0,g=a.fees||s.fees||{},V=Q(g.slippage_percent||g.slippage||s.slippage)||.5,$=Q(j.gas||g.gas_usd||g.gas)||0,_=s.tx||{},N=typeof _.to=="string"?_.to:void 0;return p===0&&!u.address&&!b.address?null:{type:c,fromToken:u,toToken:b,amountUsd:p,slippagePercent:V,gasEstimateUsd:$,contractAddress:N}}function Q(r){if(typeof r=="number"&&Number.isFinite(r))return r;if(typeof r=="string"){const s=r.replace(/[,$%]/g,"").trim(),n=Number(s);if(Number.isFinite(n))return n}}function as({panel:r,walletAddress:s,walletReady:n=!1,onExecuteQuote:c,onRefreshQuote:i,onInsertQuickPrompt:u,controls:o}){var xe,he,fe;const a=r.payload||{},f=a.breakdown||{},b=f.output||{},j=f.fees||{},m=Array.isArray(a.instructions)?a.instructions.map(t=>String(t)):[],w=Array.isArray(a.issues)?a.issues:[],p=a.actions&&typeof a.actions=="object"?a.actions:null,g=p?Object.entries(p).map(([t,d])=>({key:t,label:String(d||"").trim()})).filter(t=>t.label.length>0):[],V=typeof f.eta_seconds=="number"?f.eta_seconds:void 0,$=typeof((xe=a.wallet)==null?void 0:xe.address)=="string"?a.wallet.address:void 0,N=(typeof a.quote_type=="string"?a.quote_type.toLowerCase():r.id==="relay_swap_quote"?"swap":"bridge")==="swap",D=N?"swap":"bridge",C=N?"Swap":"Bridge",I=N?"swapping":"bridging",z=N?"Swapping…":"Bridging…",[te,ae]=T.useState(!1),[J,re]=T.useState(!1),[ne,G]=T.useState(null),[ie,oe]=T.useState(null),[E,Pe]=T.useState(!1),[M,Ue]=T.useState(!1),le=T.useMemo(()=>ts(r),[r]),Y=Je({walletAddress:s||null,intent:le}),U=a.quote_expiry;let k;if(typeof U=="string"){const t=Date.parse(U);Number.isNaN(t)||(k=t)}else if(U){const t=U.iso||U.ISO;if(t){const d=Date.parse(String(t));Number.isNaN(d)||(k=d)}if(typeof k>"u"){const d=U.epoch??U.EPOCH;if(typeof d<"u"){const h=Number(d);Number.isFinite(h)&&(k=h>1e12?h:h*1e3)}}}const H=typeof k=="number"?new Date(k):void 0,Z=typeof k=="number"?k<=Date.now():!1,L=!!(s&&$&&s.toLowerCase()!==$.toLowerCase()),ce=t=>{if(typeof t=="number")return t;if(typeof t=="string"&&t.trim().length){const d=Number(t);if(Number.isFinite(d))return d}},ee=t=>{const d=ce(t);if(typeof d!="number")return"—";const v=Math.abs(d)>=1?{minimumFractionDigits:2,maximumFractionDigits:2}:{minimumFractionDigits:2,maximumFractionDigits:4};return`$${d.toLocaleString(void 0,v)}`},de=(()=>{var R,W,ge;const t=b.amount_estimate||b.amount||((R=a.output)==null?void 0:R.amount),d=b.symbol||((ge=(W=a.output)==null?void 0:W.token)==null?void 0:ge.symbol);if(!t)return d?`— ${d}`:"—";const h=ce(t),v=typeof h=="number"?h.toLocaleString(void 0,{maximumFractionDigits:6}):String(t);return d?`${v} ${d}`:v})(),K=((he=a.usd_estimates)==null?void 0:he.output)||b.value_usd,Ae=((fe=a.usd_estimates)==null?void 0:fe.gas)||j.gas_usd,_e=t=>{if(!t||t<=0)return"—";if(t<60)return`${Math.round(t)}s`;const d=Math.round(t/60);if(d<60)return`${d} min`;const h=Math.round(d/60);if(h<24)return`${h} hr`;const v=Math.round(h/24);return`${v} day${v>1?"s":""}`},ue=()=>{if(!k)return"—";const t=k-Date.now(),d=Math.abs(t),h=t>=0?"in ":"";if(d<6e4)return t>=0?"in under a minute":"expired just now";const v=Math.round(d/6e4);if(v<60)return`${h}${v} min${t<0?" ago":""}`;const R=Math.round(v/60);if(R<24)return`${h}${R} hr${t<0?" ago":""}`;const W=Math.round(R/24);return`${h}${W} day${W>1?"s":""}${t<0?" ago":""}`},B=n?a.tx?a.status!=="ok"?"Quote is incomplete. Ask for a refresh.":Z?`Quote expired. Refresh before ${I}.`:L?"Connect the wallet that requested this quote.":Y.canProceed?null:"Policy check failed. Review issues below.":"Quote did not include a prepared transaction.":`Connect a wallet to ${D}.`,me=!B&&!!c,Ie=async()=>{if(!(!c||!me)){ae(!0),G(null),oe(null);try{const t=await c(r);typeof t=="string"&&t&&oe(t)}catch(t){G((t==null?void 0:t.message)||`${C} transaction failed.`)}finally{ae(!1)}}},pe=async()=>{if(i){re(!0),G(null);try{await i()}catch(t){G((t==null?void 0:t.message)||"Failed to refresh quote.")}finally{re(!1)}}},F=Array.isArray(a==null?void 0:a.routes)?a.routes.length:Array.isArray(a==null?void 0:a.path)?a.path.length:void 0,l=He[N?"swap":"bridge"],S=!!(o!=null&&o.collapsed),Ee=l.overlays.map((t,d)=>e.jsx("div",{className:`pointer-events-none ${t}`},d)),Me=$?`${$.slice(0,6)}…${$.slice(-4)}`:"—",q=({label:t,value:d,helper:h,tone:v="neutral"})=>e.jsxs("div",{className:l.statCard,children:[e.jsx("div",{className:l.statLabel,children:t}),e.jsx("div",{className:`${l.statValue} ${v==="danger"?l.accent.negative:"text-white"}`,children:d}),h&&e.jsx("div",{className:`${l.statHelper} ${v==="danger"?l.accent.negative:""}`,children:h})]}),A=[];return N?A.push("Swap"):A.push("Bridge"),F&&A.push(`${F} hop${F>1?"s":""}`),a!=null&&a.chain?A.push(String(a.chain)):a!=null&&a.network&&A.push(String(a.network)),e.jsxs("div",{className:`relative overflow-hidden ${l.container}`,children:[e.jsx("div",{className:`pointer-events-none absolute inset-0 rounded-[inherit] border ${l.border}`}),o&&e.jsxs("div",{className:"absolute right-4 top-4 z-20 flex items-center gap-2",children:[e.jsx("div",{className:`${l.ghostAction} h-9 w-9 items-center justify-center`,title:"Reorder",children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:o.onToggleCollapse,className:`${l.ghostAction} h-9 w-9 items-center justify-center`,title:o.collapsed?"Expand panel":"Minimize panel",children:o.collapsed?e.jsx(Te,{className:"h-4 w-4"}):e.jsx(X,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:o.onExpand,className:`${l.ghostAction} h-9 w-9 items-center justify-center`,title:"Expand",children:e.jsx(We,{className:"h-4 w-4"})})]}),Ee,e.jsxs("div",{className:"relative space-y-4 text-sm text-white/85",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:`text-[11px] uppercase tracking-[0.28em] ${l.label}`,children:N?"Swap quote":"Bridge quote"}),e.jsx("div",{className:"mt-2 text-2xl font-semibold text-white",children:(a==null?void 0:a.title)||"Relay execution summary"}),e.jsx("div",{className:`mt-1 text-xs ${l.helper}`,children:(a==null?void 0:a.description)||(N?"Sherpa tuned a best-route swap path ready for Relay.":"Sherpa tuned a best-route bridge path ready for Relay.")})]}),A.length>0&&e.jsx("div",{className:`flex flex-wrap justify-end gap-2 ${S?"opacity-80":""}`,children:A.map((t,d)=>e.jsx("span",{className:l.metaChip,children:t},d))})]}),S?e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.jsx(q,{label:"Estimated Output",value:de,helper:K?ee(K):void 0}),e.jsx(q,{label:"Quote Expiry",value:H?H.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}):"—",helper:k?ue():void 0,tone:Z?"danger":"neutral"})]}):e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.jsx(q,{label:"Estimated Output",value:de,helper:K?ee(K):void 0}),e.jsx(q,{label:"Fees",value:ee(Ae),helper:typeof j.slippage_percent=="number"?`Slippage ${j.slippage_percent}%`:void 0}),e.jsx(q,{label:"ETA",value:_e(V),helper:F?`${F} step path`:void 0}),e.jsx(q,{label:"Quote Expiry",value:H?H.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}):"—",helper:k?ue():void 0,tone:Z?"danger":"neutral"})]}),S?e.jsxs("div",{className:`${l.summaryCard} ${L?"border-amber-400 bg-amber-300/25 text-amber-100":""}`,children:[e.jsx("div",{className:`${l.statLabel} text-[10px]`,children:"Destination Wallet"}),e.jsx("div",{className:l.summaryValue,children:Me})]}):e.jsxs("div",{className:`${l.section} ${L?"border-amber-400 bg-amber-300/20 text-amber-100":""}`,children:[e.jsx("div",{className:`text-[11px] uppercase tracking-[0.2em] ${L?"text-amber-100":l.label}`,children:"Destination Wallet"}),e.jsx("div",{className:"mt-2 break-all font-mono text-sm text-white",children:$||"—"}),L&&e.jsxs("div",{className:"mt-2 text-xs",children:["Connected wallet differs from the quote wallet. Switch wallets before ",I,"."]})]}),S&&L&&e.jsxs("div",{className:"text-[10px] text-amber-200/80",children:["Switch wallets before ",I,"."]}),S&&(m.length>0||g.length>0)&&e.jsxs("div",{className:"flex flex-wrap gap-2 text-[10px] text-white/75",children:[m.length>0&&e.jsxs("span",{className:l.metaChip,children:["Instructions ",m.length]}),g.length>0&&e.jsxs("span",{className:l.metaChip,children:["Prompts ",g.length]})]}),w.length>0&&e.jsxs("div",{className:l.warningSection,children:[e.jsx("div",{className:"font-semibold uppercase tracking-wide",children:"Needs attention"}),e.jsx("ul",{className:"mt-2 list-disc space-y-1 pl-4",children:w.map((t,d)=>e.jsx("li",{children:String(t)},d))})]}),!S&&m.length>0&&e.jsxs("div",{className:`${l.section} space-y-3`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:`text-[11px] uppercase tracking-[0.2em] ${l.label}`,children:"Instructions"}),e.jsxs("button",{type:"button",onClick:()=>Pe(t=>!t),className:`${l.chip.base} ${E?l.chip.active:""}`,"aria-expanded":E,children:[E?e.jsx(X,{className:"h-3.5 w-3.5"}):e.jsx(je,{className:"h-3.5 w-3.5"}),E?"Hide":`${m.length}`]})]}),!E&&m[0]&&e.jsx("div",{className:`truncate text-xs ${l.helper}`,children:m[0]}),E&&e.jsx("ul",{className:"space-y-2 text-sm text-white/90",children:m.map((t,d)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-white/60"}),e.jsx("span",{children:t})]},d))})]}),!S&&g.length>0&&e.jsxs("div",{className:`${l.section} space-y-3`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:`text-[11px] uppercase tracking-[0.2em] ${l.label}`,children:"Quick prompts"}),e.jsxs("button",{type:"button",onClick:()=>Ue(t=>!t),className:`${l.chip.base} ${M?l.chip.active:""}`,"aria-expanded":M,children:[M?e.jsx(X,{className:"h-3.5 w-3.5"}):e.jsx(je,{className:"h-3.5 w-3.5"}),M?"Hide":`${g.length}`]})]}),!M&&g[0]&&e.jsx("div",{className:`truncate text-xs ${l.helper}`,children:g[0].label}),M&&e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(({key:t,label:d})=>e.jsxs("button",{type:"button",className:`${l.promptPill} max-w-[220px] truncate`,onClick:()=>{u&&u(d)},title:d,children:[e.jsx(ze,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"truncate",children:d})]},t))})]}),n&&le&&Y.checks.length>0&&e.jsx(Xe,{result:Y,compact:S}),!S&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("button",{type:"button",className:l.actionPrimary,onClick:Ie,disabled:!me||te,children:te?z:C}),i&&e.jsx("button",{type:"button",className:l.actionSecondary,onClick:pe,disabled:J,children:J?"Refreshing…":e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"h-4 w-4"}),"Refresh Quote"]})}),B&&e.jsx("span",{className:`text-xs ${l.helper}`,children:B})]}),S&&B&&e.jsx("div",{className:`text-xs ${l.helper}`,children:B}),ne&&e.jsx(Re,{message:ne,onRetry:i?pe:void 0,retryLabel:J?"Refreshing…":"Retry",className:l.section}),ie&&e.jsxs("div",{className:`${l.section} text-xs ${l.successText}`,children:["Transaction submitted: ",e.jsx("code",{className:"font-mono",children:ie})]})]})]})}const rs=T.memo(as);rs.displayName="RelayQuoteWidget";export{rs as RelayQuoteWidget,rs as default};
