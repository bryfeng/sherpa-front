import{d9 as w,dd as x,d6 as e,ei as N,d7 as P,ej as q}from"./index-Dide1ZUj.js";import{C as E,u as D}from"./useRiskPolicy-Bc1Sfk42.js";import{a as S,f as j}from"./policy-BUGY-p8W.js";import{C as L}from"./chevron-down-DMOhZkTO.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=w("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=w("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=w("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function b({title:o,children:l,defaultOpen:t=!0}){const[n,r]=x.useState(t);return e.jsxs("div",{className:"border rounded-xl",style:{borderColor:"var(--line)"},children:[e.jsxs("button",{type:"button",onClick:()=>r(!n),className:"flex w-full items-center justify-between px-4 py-3 text-left",children:[e.jsx("span",{className:"text-sm font-medium",style:{color:"var(--text)"},children:o}),n?e.jsx(L,{className:"h-4 w-4",style:{color:"var(--text-muted)"}}):e.jsx(E,{className:"h-4 w-4",style:{color:"var(--text-muted)"}})]}),n&&e.jsx("div",{className:"border-t px-4 pb-4 pt-3 space-y-4",style:{borderColor:"var(--line)"},children:l})]})}function f({label:o,value:l,min:t,max:n,step:r=1,unit:d="",hint:s,onChange:i}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:o}),e.jsxs("span",{className:"text-sm font-medium",style:{color:"var(--text)"},children:[l,d]})]}),e.jsx("input",{type:"range",min:t,max:n,step:r,value:l,onChange:p=>i(parseFloat(p.target.value)),className:"w-full h-2 rounded-full appearance-none cursor-pointer",style:{background:`linear-gradient(to right, var(--accent) 0%, var(--accent) ${(l-t)/(n-t)*100}%, var(--surface-3) ${(l-t)/(n-t)*100}%, var(--surface-3) 100%)`}}),s&&e.jsx("p",{className:"text-[11px]",style:{color:"var(--text-muted)"},children:s})]})}function h({label:o,value:l,hint:t,onChange:n}){const[r,d]=x.useState(l.toString());x.useEffect(()=>{d(l.toString())},[l]);const s=()=>{const i=parseFloat(r.replace(/[^0-9.]/g,""));!isNaN(i)&&i>=0?n(i):d(l.toString())};return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:o}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm",style:{color:"var(--text-muted)"},children:"$"}),e.jsx("input",{type:"text",value:r,onChange:i=>d(i.target.value),onBlur:s,className:"w-full rounded-lg border py-2 pl-7 pr-3 text-sm",style:{borderColor:"var(--line)",background:"var(--surface-2)",color:"var(--text)"}})]}),t&&e.jsx("p",{className:"text-[11px]",style:{color:"var(--text-muted)"},children:t})]})}function $({config:o,isDefault:l,isSaving:t=!1,onSave:n,onReset:r,onApplyPreset:d}){const[s,i]=x.useState(o),[p,y]=x.useState(null),[u,v]=x.useState(null);x.useEffect(()=>{i(o)},[o]),x.useEffect(()=>{for(const[a,m]of Object.entries(S))if(Object.entries(m.config).every(([R,A])=>s[R]===A)){y(a);return}y(null)},[s]);const c=x.useCallback((a,m)=>{i(k=>({...k,[a]:m})),v(null)},[]),U=async()=>{if(s.warnSlippagePercent>=s.maxSlippagePercent){v("Warn slippage must be less than max slippage");return}if(s.warnGasPercent>=s.maxGasPercent){v("Warn gas must be less than max gas");return}if(s.requireApprovalAboveUsd>s.maxSingleTxUsd){v("Approval threshold cannot exceed max transaction limit");return}try{await n(s)}catch(a){v(a instanceof Error?a.message:"Failed to save")}},M=async a=>{try{await d(a)}catch(m){v(m instanceof Error?m.message:"Failed to apply preset")}},C=JSON.stringify(s)!==JSON.stringify(o);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl",style:{background:"var(--surface-2)"},children:e.jsx(N,{className:"h-5 w-5",style:{color:"var(--accent)"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold",style:{color:"var(--text)"},children:"Trading Risk Preferences"}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Configure limits to protect your portfolio"})]})]}),e.jsx("div",{className:"flex gap-2",children:Object.entries(S).map(([a,m])=>e.jsx("button",{type:"button",onClick:()=>M(a),className:`flex-1 rounded-lg border px-3 py-2 text-xs font-medium transition ${p===a?"border-[var(--accent)] bg-[var(--accent)]/10":"border-[var(--line)] hover:border-[var(--accent)]/50"}`,style:{color:p===a?"var(--accent)":"var(--text)"},children:m.name},a))}),u&&e.jsx("div",{className:"rounded-lg border px-3 py-2 text-xs",style:{borderColor:"var(--error)",background:"var(--error)/10",color:"var(--error)"},children:u}),e.jsxs(b,{title:"Position Limits",children:[e.jsx(f,{label:"Max % of portfolio in single asset",value:s.maxPositionPercent,min:1,max:100,step:1,unit:"%",onChange:a=>c("maxPositionPercent",a)}),e.jsx(h,{label:"Max position value",value:s.maxPositionValueUsd,onChange:a=>c("maxPositionValueUsd",a)})]}),e.jsxs(b,{title:"Daily Limits",children:[e.jsx(h,{label:"Max daily trading volume",value:s.maxDailyVolumeUsd,onChange:a=>c("maxDailyVolumeUsd",a)}),e.jsx(h,{label:"Max daily loss (stop trading if reached)",value:s.maxDailyLossUsd,hint:"Trading will pause for the day if losses exceed this",onChange:a=>c("maxDailyLossUsd",a)})]}),e.jsxs(b,{title:"Transaction Limits",children:[e.jsx(h,{label:"Max single transaction",value:s.maxSingleTxUsd,onChange:a=>c("maxSingleTxUsd",a)}),e.jsx(h,{label:"Require approval above",value:s.requireApprovalAboveUsd,hint:"Transactions above this require manual confirmation",onChange:a=>c("requireApprovalAboveUsd",a)})]}),e.jsxs(b,{title:"Advanced Settings",defaultOpen:!1,children:[e.jsx(f,{label:"Max slippage tolerance",value:s.maxSlippagePercent,min:.1,max:10,step:.1,unit:"%",onChange:a=>c("maxSlippagePercent",a)}),e.jsx(f,{label:"Warn slippage above",value:s.warnSlippagePercent,min:.1,max:s.maxSlippagePercent-.1,step:.1,unit:"%",onChange:a=>c("warnSlippagePercent",a)}),e.jsx(f,{label:"Max gas as % of transaction",value:s.maxGasPercent,min:.1,max:20,step:.1,unit:"%",onChange:a=>c("maxGasPercent",a)}),e.jsx(f,{label:"Warn gas above",value:s.warnGasPercent,min:.1,max:s.maxGasPercent-.1,step:.1,unit:"%",onChange:a=>c("warnGasPercent",a)}),e.jsx(h,{label:"Minimum pool liquidity",value:s.minLiquidityUsd,hint:"Skip trades in pools with less liquidity",onChange:a=>c("minLiquidityUsd",a)})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-xl border px-4 py-3",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:"Enable Risk Policies"}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Apply these limits to all trading activity"})]}),e.jsx("button",{type:"button",onClick:()=>c("enabled",!s.enabled),className:`relative h-6 w-11 rounded-full transition ${s.enabled?"bg-[var(--accent)]":"bg-[var(--surface-3)]"}`,children:e.jsx("span",{className:`absolute top-0.5 h-5 w-5 rounded-full bg-white shadow transition ${s.enabled?"left-5":"left-0.5"}`})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button",onClick:r,className:"flex items-center gap-1.5 rounded-lg border px-3 py-2 text-xs font-medium transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text-muted)"},children:[e.jsx(V,{className:"h-3.5 w-3.5"}),"Reset to Defaults"]}),e.jsxs("button",{type:"button",onClick:U,disabled:!C||t,className:`ml-auto flex items-center gap-1.5 rounded-lg px-4 py-2 text-xs font-medium transition ${C&&!t?"bg-[var(--accent)] text-white hover:opacity-90":"bg-[var(--surface-3)] text-[var(--text-muted)] cursor-not-allowed"}`,children:[e.jsx(F,{className:"h-3.5 w-3.5"}),t?"Saving...":"Save Preferences"]})]}),l&&e.jsx("p",{className:"text-center text-xs",style:{color:"var(--text-muted)"},children:"Using default settings. Save to create your custom policy."})]})}function g({label:o,value:l,status:t}){return e.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:o}),e.jsxs("span",{className:"text-xs font-medium flex items-center gap-1",style:{color:t==="warning"?"var(--warning)":"var(--text)"},children:[l,t==="ok"&&e.jsx(q,{className:"h-3 w-3",style:{color:"var(--success)"}}),t==="warning"&&e.jsx(P,{className:"h-3 w-3"})]})]})}function I({widget:o,walletAddress:l}){const[t,n]=x.useState(!1),{config:r,isDefault:d,isLoading:s,save:i,reset:p,applyPreset:y}=D({walletAddress:l});return l?s?e.jsxs("div",{className:"animate-pulse space-y-3 p-4",children:[e.jsx("div",{className:"h-10 rounded-lg",style:{background:"var(--surface-3)"}}),e.jsx("div",{className:"h-24 rounded-lg",style:{background:"var(--surface-3)"}}),e.jsx("div",{className:"h-8 rounded-lg",style:{background:"var(--surface-3)"}})]}):t?e.jsxs("div",{className:"p-4",children:[e.jsx($,{config:r,isDefault:d,onSave:async u=>{await i(u),n(!1)},onReset:p,onApplyPreset:y}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"mt-4 w-full rounded-lg border py-2 text-xs font-medium transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text-muted)"},children:"Cancel"})]}):e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl",style:{background:r.enabled?"var(--accent)/10":"var(--surface-3)"},children:e.jsx(N,{className:"h-5 w-5",style:{color:r.enabled?"var(--accent)":"var(--text-muted)"}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:"Risk Policy"}),e.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[r.enabled?"Active":"Disabled",d&&" (defaults)"]})]})]}),e.jsxs("button",{type:"button",onClick:()=>n(!0),className:"flex items-center gap-1 rounded-lg border px-2.5 py-1.5 text-xs font-medium transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text)"},children:[e.jsx(T,{className:"h-3.5 w-3.5"}),"Edit"]})]}),e.jsxs("div",{className:"rounded-xl border divide-y",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(g,{label:"Max single transaction",value:j(r.maxSingleTxUsd),status:"ok"})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(g,{label:"Daily volume limit",value:j(r.maxDailyVolumeUsd),status:"ok"})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(g,{label:"Max position size",value:`${r.maxPositionPercent}%`,status:"ok"})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(g,{label:"Approval required above",value:j(r.requireApprovalAboveUsd)})}),e.jsx("div",{className:"px-3",style:{borderColor:"var(--line)"},children:e.jsx(g,{label:"Max slippage",value:`${r.maxSlippagePercent}%`,status:r.maxSlippagePercent>3?"warning":"ok"})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["conservative","moderate","aggressive"].map(u=>e.jsx("button",{type:"button",onClick:()=>y(u),className:"rounded-lg border px-2 py-1.5 text-[11px] font-medium capitalize transition hover:bg-[var(--surface-2)]",style:{borderColor:"var(--line)",color:"var(--text-muted)"},children:u},u))}),!r.enabled&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border px-3 py-2",style:{borderColor:"var(--warning)",background:"var(--warning)/5"},children:[e.jsx(P,{className:"h-4 w-4",style:{color:"var(--warning)"}}),e.jsx("p",{className:"text-xs",style:{color:"var(--warning)"},children:"Risk policies are disabled. Your trades will not be protected."})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 rounded-xl border p-6 text-center",style:{borderColor:"var(--line)",background:"var(--surface-2)"},children:[e.jsx(N,{className:"h-8 w-8",style:{color:"var(--text-muted)"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:"Connect Wallet"}),e.jsx("p",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:"Connect your wallet to configure risk policies"})]})]})}export{I as RiskPolicyWidget};
